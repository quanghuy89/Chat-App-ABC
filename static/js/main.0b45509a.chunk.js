(this.webpackJsonpsrc=this.webpackJsonpsrc||[]).push([[0],{178:function(e,t,n){},179:function(e,t,n){},263:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(46),r=n.n(i),o=(n(178),n(179),n(91)),s=n.n(o),l=n(111),d=n(271),u=n(267),b=n(268),j=n(272),p=n(77),m=n(94);n(264),n(181),n(265);m.a.initializeApp({apiKey:"AIzaSyDJfTtDCI4XOGXaGLwxHxBaye4WcJI3Ywg",authDomain:"chat-app-13a97.firebaseapp.com",projectId:"chat-app-13a97",storageBucket:"chat-app-13a97.appspot.com",messagingSenderId:"1092770954741",appId:"1:1092770954741:web:21f035fb54b4e969ea74bc",measurementId:"G-WN6RD6FNZ8"}),m.a.analytics();var h=m.a.auth(),x=m.a.firestore(),f=m.a,O=n(93),v=n(59),g=function(e,t){x.collection(e).add(Object(v.a)(Object(v.a)({},t),{},{createdAt:f.firestore.FieldValue.serverTimestamp()}))},y=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],i=[],r=0;r<n;r++)a[r]=!1;return function e(r){for(var o=0;o<n;o++)a[o]||(a[o]=!0,c[r]=t[o],r===n-1&&i.push(c.join(" ")),e(r+1),a[o]=!1)}(0),i.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(O.a)(e),Object(O.a)(n))}),[])},w=n(7),C=d.a.Title,I=new f.auth.GoogleAuthProvider;function N(){var e=function(){var e=Object(l.a)(s.a.mark((function e(t){var n,a,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.signInWithPopup(t);case 2:n=e.sent,a=n.additionalUserInfo,c=n.user,(null===a||void 0===a?void 0:a.isNewUser)&&g("users",{displayName:c.displayName,email:c.email,photoURL:c.photoURL,uid:c.uid,providerId:a.providerId,keywords:y(null===(i=c.displayName)||void 0===i?void 0:i.toLowerCase())});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)("div",{children:Object(w.jsx)(u.a,{justify:"center",style:{height:800},children:Object(w.jsxs)(b.a,{span:6,children:[Object(w.jsx)("center",{children:Object(w.jsx)(j.a,{style:{width:210,marginTop:30,marginLeft:10},src:"logo.png",preview:!1})}),Object(w.jsx)(C,{style:{textAlign:"center",marginTop:15},level:2,children:"Group04 Chat App"}),Object(w.jsx)(p.a,{style:{width:"100%",marginTop:25,background:"lightblue",color:"black",borderRadius:10},onClick:function(){return e(I)},children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Google"})]})})})}var R=n(140),k=n(30),A=n(43),L=n(275),U=n(44),S=n(33),T=n(269),V=c.a.createContext();function F(e){var t=e.children,n=Object(a.useState)({}),i=Object(S.a)(n,2),r=i[0],o=i[1],s=Object(k.f)(),l=Object(a.useState)(!0),d=Object(S.a)(l,2),u=d[0],b=d[1];return c.a.useEffect((function(){var e=h.onAuthStateChanged((function(e){if(e){var t=e.displayName,n=e.email,a=e.uid,c=e.photoURL;return o({displayName:t,email:n,uid:a,photoURL:c}),b(!1),void s.push("/")}o({}),b(!1),s.push("/login")}));return function(){e()}}),[s]),Object(w.jsx)(V.Provider,{value:{user:r},children:u?Object(w.jsx)(T.a,{style:{position:"fixed",inset:0}}):t})}var M,z=function(e,t){var n=Object(a.useState)([]),i=Object(S.a)(n,2),r=i[0],o=i[1];return c.a.useEffect((function(){var n=x.collection(e).orderBy("createdAt");if(t){if(!t.compareValue||!t.compareValue.length)return void o([]);n=n.where(t.fieldName,t.operator,t.compareValue)}return n.onSnapshot((function(e){var t=e.docs.map((function(e){return Object(v.a)(Object(v.a)({},e.data()),{},{id:e.id})}));o(t)}))}),[e,t]),r},_=c.a.createContext();function B(e){var t=e.children,n=Object(a.useState)(!1),i=Object(S.a)(n,2),r=i[0],o=i[1],s=Object(a.useState)(!1),l=Object(S.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)(""),j=Object(S.a)(b,2),p=j[0],m=j[1],h=Object(a.useState)(""),x=Object(S.a)(h,1)[0],f=c.a.useContext(V).user.uid,O=c.a.useMemo((function(){return{fieldName:"members",operator:"array-contains",compareValue:f}}),[f]),v=z("rooms",O),g=c.a.useMemo((function(){return v.find((function(e){return e.id===p}))||{}}),[v,p]);x=g.createdBy;var y=c.a.useMemo((function(){return{fieldName:"uid",operator:"in",compareValue:g.members}}),[g.members]),C=z("users",y);return Object(w.jsx)(_.Provider,{value:{rooms:v,members:C,selectedRoom:g,createdBy:x,isAddRoomVisible:r,setIsAddRoomVisible:o,selectedRoomId:p,setSelectedRoomId:m,isInviteMemberVisible:d,setIsInviteMemberVisible:u,clearState:function(){m(""),o(!1),u(!1)}},children:t})}var P=U.a.div(M||(M=Object(A.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tborder-bottom: 1px solid rgba(82, 38, 83);\n\tpadding: 12px 16px;\n\n\t.avatar {\n\t\tmargin-bottom: 6px;\n\t}\n\n\t.username {\n\t\tcolor: #fff;\n\t\tfont-size: 18px;\n\t\tmargin-left: 10px;\n\t\tpadding: 10px 0px;\n\t}\n"])));function D(){var e,t=c.a.useContext(V).user,n=t.displayName,a=t.photoURL,i=c.a.useContext(_).clearState;return Object(w.jsxs)(P,{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)(L.a,{className:"avatar",src:a,children:a?"":null===n||void 0===n||null===(e=n.charAt(0))||void 0===e?void 0:e.toUpperCase()}),Object(w.jsx)(d.a.Text,{className:"username",children:n})]}),Object(w.jsx)(p.a,{ghost:!0,onClick:function(){i(),h.signOut()},children:"\u0110\u0103ng xu\u1ea5t"})]})}var E,G,J,H=n(276),W=n(280),K=H.a.Panel,X=Object(U.a)(K)(E||(E=Object(A.a)(["\n  &&& {\n    .ant-collapse-header,\n    p {\n      color:white;\n      font-size:20px;\n    }\n\n    .ant-collapse-content-box {\n      padding: 0 40px;\n    }\n\n    .add-room {\n      color:white;\n      font-size:20px;\n      padding: 0;\n    }\n  }\n"]))),Y=Object(U.a)(d.a.Link)(G||(G=Object(A.a)(["\n  display: block;\n  margin-bottom: 5px;\n  color:white;\n  font-size:20px;\n"])));function Z(){var e=c.a.useContext(_),t=e.rooms,n=e.setIsAddRoomVisible,a=e.setSelectedRoomId;return Object(w.jsx)(H.a,{ghost:!0,defaultActiveKey:["1"],children:Object(w.jsxs)(X,{header:"Danh s\xe1ch c\xe1c ph\xf2ng",children:[t.map((function(e){return Object(w.jsx)(Y,{onClick:function(){return a(e.id)},children:e.name},e.id)})),Object(w.jsx)(p.a,{type:"text",icon:Object(w.jsx)(W.a,{}),className:"add-room",onClick:function(){n(!0)},children:"Th\xeam ph\xf2ng"})]},"1")})}var q=U.a.div(J||(J=Object(A.a)(["\n  background: #a4508b;\n  background-image: linear-gradient(326deg, #a4508b 0%, #5f0a87 74%);\n\n  color: #000;\n  height: 100vh;\n"])));function Q(){return Object(w.jsx)(q,{children:Object(w.jsxs)(u.a,{children:[Object(w.jsx)(b.a,{span:24,children:Object(w.jsx)(D,{})}),Object(w.jsx)(b.a,{span:24,children:Object(w.jsx)(Z,{})})]})})}var $,ee,te,ne,ae,ce,ie,re=n(281),oe=n(273),se=n(69),le=n(277),de=n(279),ue=n(270),be=U.a.div($||($=Object(A.a)(["\n\t.message {\n\t\tmargin-bottom: 15px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\n\t.author {\n\t\tmargin-left: 44px;\n\t\tmargin-bottom: 5px;\n\t\tfont-weight: bold;\n\t\tcolor: #848689;\n\t}\n\n\t.date {\n\t\tmargin-left: 10px;\n\t\tfont-size: 11px;\n\t\tcolor: #a7a7a7;\n\t}\n\n\t.content {\n\t\tmargin-left: 10px;\n\t\tbackground: rgb(245, 241, 241);\n\t\tcolor: black;\n\t\tborder-radius: 10px;\n\t\tmargin-bottom: 5px;\n\t\tfont-size: 15px;\n\t\tpadding: 10px;\n\t\tdisplay: inline-block;\n\t\tmax-width: 351px;\n\t}\n\n\t.message.own {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmargin-bottom: 0px;\n\t\tmargin-right: 10px;\n\t\talign-items: flex-end;\n\t}\n\n\t.message.own .content {\n\t\tbackground: lightblue;\n\t\tcolor: black;\n\t\tborder-radius: 10px;\n\t\tfont-size: 15px;\n\t\tpadding: 10px;\n\t\tmargin-bottom: 10px;\n\t\tdisplay: inline-block;\n\t\tmax-width: 351px;\n\t}\n"])));function je(e){var t="";return e&&(t=(t=Object(ue.a)(new Date(1e3*e),new Date)).charAt(0).toUpperCase()+t.slice(1)),t}function pe(e){var t,n=e.text,a=e.displayName,c=e.createdAt,i=e.photoURL,r=e.own;return Object(w.jsx)(be,{children:Object(w.jsxs)("div",{className:r?"message own":"message",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)(d.a.Text,{className:"author",hidden:r,children:a}),Object(w.jsx)(d.a.Text,{className:"date",hidden:r,children:je(null===c||void 0===c?void 0:c.seconds)})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)(L.a,{size:"medium",src:i,title:r?"You":a,children:i?"":null===a||void 0===a||null===(t=a.charAt(0))||void 0===t?void 0:t.toUpperCase()}),Object(w.jsx)(d.a.Paragraph,{className:"content",title:je(null===c||void 0===c?void 0:c.seconds),children:n})]})]})})}var me=U.a.div(ee||(ee=Object(A.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\theight: 56px;\n\tpadding: 0 16px;\n\talign-items: center;\n\tborder-bottom: 1px solid rgb(230, 230, 230);\n\n\tbackground-color: #37e2d5;\n\n\t.header {\n\t\t&__info {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tjustify-content: center;\n\t\t}\n\n\t\t&__title {\n\t\t\tmargin: 0;\n\t\t\tfont-weight: bold;\n\t\t}\n\n\t\t&__description {\n\t\t\tfont-size: 12px;\n\t\t}\n\t}\n"]))),he=U.a.div(te||(te=Object(A.a)(["\n\tdisplay: flex;\n\talign-items: center;\n"]))),xe=U.a.div(ne||(ne=Object(A.a)(["\n\theight: 100vh;\n"]))),fe=U.a.div(ae||(ae=Object(A.a)(["\n\theight: calc(100% - 56px);\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: 11px;\n\tjustify-content: flex-end;\n"]))),Oe=Object(U.a)(oe.a)(ce||(ce=Object(A.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tmargin-top: 10px;\n\tpadding: 2px 2px 2px 2px;\n\tborder: 2px solid black;\n\tborder-radius: 10px;\n\n\t.ant-form-item {\n\t\tflex: 1;\n\t\tmargin-bottom: 0;\n\t}\n\n\t.btn-submit {\n\t\tbackground: lightblue;\n\t\tcolor: black;\n\t\tborder-radius: 10px;\n\t}\n"]))),ve=U.a.div(ie||(ie=Object(A.a)(["\n\tmax-height: 100%;\n\toverflow-y: auto;\n"])));function ge(){var e=Object(a.useContext)(_),t=e.selectedRoom,n=(e.createdBy,e.members),i=e.setIsInviteMemberVisible,r=Object(a.useContext)(V).user,o=r.uid,s=r.photoURL,l=r.displayName,d=Object(a.useState)(""),u=Object(S.a)(d,2),b=u[0],j=u[1],m=oe.a.useForm(),h=Object(S.a)(m,1)[0],x=Object(a.useRef)(null),f=Object(a.useRef)(null),O=function(){g("messages",{text:b,uid:o,photoURL:s,roomId:t.id,displayName:l}),h.resetFields(["message"]),(null===x||void 0===x?void 0:x.current)&&setTimeout((function(){x.current.focus()}))},v=c.a.useMemo((function(){return{fieldName:"roomId",operator:"==",compareValue:t.id}}),[t.id]),y=z("messages",v);return Object(a.useEffect)((function(){(null===f||void 0===f?void 0:f.current)&&(f.current.scrollTop=f.current.scrollHeight+50)}),[y]),Object(w.jsx)(xe,{children:t.id?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(me,{children:[Object(w.jsxs)("div",{className:"header__info",children:[Object(w.jsx)("p",{className:"header__title",children:t.name}),Object(w.jsx)("span",{className:"header__description",children:t.description})]}),Object(w.jsxs)(he,{children:[Object(w.jsx)(p.a,{icon:Object(w.jsx)(re.a,{}),type:"text",onClick:function(){return i(!0)},children:"Invite"}),Object(w.jsx)(L.a.Group,{size:"small",maxCount:2,children:n.map((function(e){var t,n;return Object(w.jsx)(se.a,{title:e.displayName,children:Object(w.jsx)(L.a,{src:e.photoURL,children:e.photoURL?"":null===(t=e.displayName)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})},e.id)}))})]})]}),Object(w.jsxs)(fe,{children:[Object(w.jsx)(ve,{ref:f,children:y.map((function(e){return Object(w.jsx)(pe,{text:e.text,photoURL:e.photoURL,displayName:e.displayName,createdAt:e.createdAt,own:e.uid===o},e.id)}))}),Object(w.jsxs)(Oe,{form:h,children:[Object(w.jsx)(oe.a.Item,{name:"message",children:Object(w.jsx)(le.a,{ref:x,onChange:function(e){j(e.target.value)},onPressEnter:O,placeholder:"Enter message...",bordered:!1,autoComplete:"off"})}),Object(w.jsx)(p.a,{className:"btn-submit",type:"primary",onClick:O,style:{color:"black",width:100,borderRadius:10,margin:5},children:"Send"})]})]})]}):Object(w.jsx)(de.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng",type:"info",showIcon:!0,style:{margin:10},closable:!0})})}function ye(){return Object(w.jsx)("div",{children:Object(w.jsxs)(u.a,{children:[Object(w.jsx)(b.a,{span:6,children:Object(w.jsx)(Q,{})}),Object(w.jsx)(b.a,{span:18,children:Object(w.jsx)(ge,{})})]})})}var we=n(274);function Ce(){var e=Object(a.useContext)(_),t=e.isAddRoomVisible,n=e.setIsAddRoomVisible,c=Object(a.useContext)(V).user.uid,i=oe.a.useForm(),r=Object(S.a)(i,1)[0];return Object(w.jsx)("div",{children:Object(w.jsx)(we.a,{title:"T\u1ea1o ph\xf2ng",visible:t,onOk:function(){g("rooms",Object(v.a)(Object(v.a)({},r.getFieldsValue()),{},{createdBy:c,members:[c]})),r.resetFields(),n(!1)},onCancel:function(){r.resetFields(),n(!1)},children:Object(w.jsxs)(oe.a,{form:r,layout:"vertical",children:[Object(w.jsx)(oe.a.Item,{label:"T\xean ph\xf2ng",name:"name",children:Object(w.jsx)(le.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(w.jsx)(oe.a.Item,{label:"M\xf4 t\u1ea3",name:"description",children:Object(w.jsx)(le.a.TextArea,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})})}var Ie=n(170),Ne=n(278),Re=n(164),ke=["fetchOptions","debounceTimeout","curMembers"];function Ae(e){var t=e.fetchOptions,n=e.debounceTimeout,i=void 0===n?300:n,r=e.curMembers,o=Object(Ie.a)(e,ke),s=Object(a.useState)(!1),l=Object(S.a)(s,2),d=l[0],u=l[1],b=Object(a.useState)([]),j=Object(S.a)(b,2),p=j[0],m=j[1],h=c.a.useMemo((function(){return Object(Re.debounce)((function(e){m([]),u(!0),t(e,r).then((function(e){m(e),u(!1)}))}),i)}),[i,t,r]);return c.a.useEffect((function(){return function(){m([])}}),[]),Object(w.jsx)(Ne.a,Object(v.a)(Object(v.a)({labelInValue:!0,filterOption:!1,onSearch:h,notFoundContent:d?Object(w.jsx)(T.a,{size:"small"}):null},o),{},{children:p.map((function(e){var t,n;return Object(w.jsxs)(Ne.a.Option,{value:e.value,title:e.label,children:[Object(w.jsx)(L.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})," ".concat(e.label)]},e.value)}))}))}function Le(e,t){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x.collection("users").where("keywords","array-contains",null===t||void 0===t?void 0:t.toLowerCase()).orderBy("displayName").limit(20).get().then((function(e){return e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}})).filter((function(e){return!n.includes(e.value)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(){var e=Object(a.useContext)(_),t=e.isInviteMemberVisible,n=e.setIsInviteMemberVisible,c=e.selectedRoomId,i=e.selectedRoom,r=Object(a.useState)([]),o=Object(S.a)(r,2),s=o[0],l=o[1],d=oe.a.useForm(),u=Object(S.a)(d,1)[0];return Object(w.jsx)("div",{children:Object(w.jsx)(we.a,{title:"M\u1eddi th\xeam th\xe0nh vi\xean",visible:t,onOk:function(){u.resetFields(),l([]),x.collection("rooms").doc(c).update({members:[].concat(Object(O.a)(i.members),Object(O.a)(s.map((function(e){return e.value}))))}),n(!1)},onCancel:function(){u.resetFields(),l([]),n(!1)},destroyOnClose:!0,children:Object(w.jsx)(oe.a,{form:u,layout:"vertical",children:Object(w.jsx)(Ae,{mode:"multiple",name:"search-user",label:"T\xean c\xe1c th\xe0nh vi\xean",value:s,placeholder:"Nh\u1eadp t\xean th\xe0nh vi\xean",fetchOptions:Le,onChange:function(e){return l(e)},style:{width:"100%"},curMembers:i.members})})})})}var Te=function(){return Object(w.jsx)(R.a,{children:Object(w.jsx)(F,{children:Object(w.jsxs)(B,{children:[Object(w.jsxs)(k.c,{children:[Object(w.jsx)(k.a,{component:N,path:"/login"}),Object(w.jsx)(k.a,{component:ye,path:"/"})]}),Object(w.jsx)(Ce,{}),Object(w.jsx)(Se,{})]})})})},Ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,282)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))};r.a.render(Object(w.jsx)(Te,{}),document.getElementById("root")),Ve()}},[[263,1,2]]]);
//# sourceMappingURL=main.0b45509a.chunk.js.map